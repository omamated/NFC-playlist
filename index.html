<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFC Playlist Setup</title>
</head>
<body>
    <h1>Set Up Your NFC Playlist</h1>
    
    <h2>Step 1: Choose Your Music App</h2>
    <button onclick="chooseApp('spotify')">Spotify</button>
    <button onclick="chooseApp('appleMusic')">Apple Music</button>
    <button onclick="chooseApp('youtubeMusic')">YouTube Music</button>

    <h2>Step 2: Enter Your Playlist Link</h2>
    <input type="text" id="playlistUrl" placeholder="Enter your playlist link">
    <button onclick="savePlaylist()">Save Playlist</button>
    
    <p id="status"></p>

    <h2>Step 3: How to Get Your Playlist Link</h2>
    <div id="instructions">
        <h3>1. Spotify:</h3>
        <ol>
            <li>Open the Spotify app or website.</li>
            <li>Go to the playlist you want to share.</li>
            <li>Click on the three dots (options menu) on the playlist.</li>
            <li>Select "Share" → "Copy Playlist Link".</li>
            <li>Paste the link in the input box above.</li>
        </ol>
        
        <h3>2. Apple Music:</h3>
        <ol>
            <li>Open the Apple Music app or website.</li>
            <li>Find the playlist you want to share.</li>
            <li>Click the three dots (options menu) and select "Share Playlist".</li>
            <li>Click "Copy Link" to copy the playlist URL.</li>
            <li>Paste the link in the input box above.</li>
        </ol>

        <h3>3. YouTube Music:</h3>
        <ol>
            <li>Open the YouTube Music app or website.</li>
            <li>Go to the playlist you want to share.</li>
            <li>Click the three dots (options menu) and select "Share".</li>
            <li>Select "Copy Link".</li>
            <li>Paste the link in the input box above.</li>
        </ol>
    </div>
    
    <p id="instructionsText">Tap your NFC tag to save your playlist. You can change it anytime.</p>

    <script>
        let selectedApp = '';

        function chooseApp(app) {
            selectedApp = app;
            alert('You selected ' + app + '. Now enter your playlist link.');
        }

        function savePlaylist() {
            let url = document.getElementById("playlistUrl").value;
            if (url.trim() === "") {
                document.getElementById("status").innerText = "⚠️ Please enter a valid URL!";
                return;
            }

            if (selectedApp === '') {
                document.getElementById("status").innerText = "⚠️ Please select a music app first!";
                return;
            }

            let playlistLink = {
                app: selectedApp,
                url: url
            };

            localStorage.setItem("playlist", JSON.stringify(playlistLink));
            document.getElementById("status").innerText = "✅ Playlist saved! Tap your NFC tag to launch your app.";
        }

        function redirectToPlaylist() {
            let playlistData = localStorage.getItem("playlist");
            if (playlistData) {
                let data = JSON.parse(playlistData);
                let app = data.app;
                let url = data.url;
                let deepLink = "";

                // Convert to deep link based on app
                if (app === "spotify") {
                    deepLink = "spotify://playlist/" + extractSpotifyId(url);
                } else if (app === "appleMusic") {
                    deepLink = "music://"; // Simplified, Apple Music doesn't support direct deep li
